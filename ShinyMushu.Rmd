---
title: "ShinyMushu"
author: "Laura Ingulsrud, Sidney Gerst, Natalie Dornan"
date: "2/7/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}

library(tidyverse)
library(janitor)
library(lubridate)
library(stringr)
library(sf)
library(tmap)
library(leaflet)
library(ggrepel)
library(ggspatial)
library(RColorBrewer)
library(raster)

```

```{r data}

HAB <- read_csv("HAB.csv") # Read in data: "Harmful Algal Blooms 2008-2019"

# Clean up the data
clean_hab <- HAB %>% 
  clean_names(., case = c("snake")) %>% # Convert to snake case
  select(year, month, day, latitude, longitude, location, akashiwo_sanguinea_cells_l, alexandrium_spp_cells_l, ammonia_u_m, chlorophyll_mg_m3, domoic_acid_ng_m_l, nitrate_u_m, nitrite_u_m, phosphate_u_m, pseudo_nitzschia_delicatissima_group_cells_l, pseudo_nitzschia_seriata_group_cells_l, silicate_u_m, water_temperature_c) %>% # Selected species that are correlated with HABs
  na.omit() %>% # Remove "NaNs" 
  rename(akashiwo = akashiwo_sanguinea_cells_l,
         alexandrium = alexandrium_spp_cells_l,
         ammonia = ammonia_u_m,
         chlorophyll = chlorophyll_mg_m3,
         domoic_acid = domoic_acid_ng_m_l,
         nitrate = nitrate_u_m,
         nitrite = nitrite_u_m,
         phosphate = phosphate_u_m,
         pseudo_nitzschia_delicatissima = pseudo_nitzschia_delicatissima_group_cells_l,
         pseudo_nitzschia_seriata = pseudo_nitzschia_seriata_group_cells_l,
         silicate = silicate_u_m,
         water_temp = water_temperature_c) %>% # Rename variables
  mutate(YearMonth = str_c(year, month, sep = "-")) # Create one column of year and month of sample together


```

```{r LAURA - Tab 2: HAB abundance chart}

chlorophyll_col <- ggplot(clean_hab, aes(x = month, y = chlorophyll)) +
  geom_col(fill = "seagreen3", color = "seagreen") +
  labs(x = "Month", y = "Chlorophyll Concentration (mg/L)") +
  theme_bw() 

chlorophyll_col

domoic_col <- ggplot(clean_hab, aes(x = month, y = domoic_acid)) +
  geom_col(fill = "cornflowerblue", color = "royalblue") +
  labs(x = "Month", y = "Domoic Acid Concentration (mg/L)") +
  theme_bw() 

domoic_col

```

```{r NATALIE - Tab 3: Correlation plot}

```























```{r SIDNEY - Tab 4: Interactive Map}

#create a map of california 
ca_counties <- read_sf(".", layer = "california_county_shape_file")

#this time give the projection
st_crs(ca_counties) = 4326



```

